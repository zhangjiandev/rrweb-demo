var rrwebRecord=function(){"use strict";var L;(function(e){e[e.Document=0]="Document",e[e.DocumentType=1]="DocumentType",e[e.Element=2]="Element",e[e.Text=3]="Text",e[e.CDATA=4]="CDATA",e[e.Comment=5]="Comment"})(L||(L={}));function zt(e){return e.nodeType===e.ELEMENT_NODE}function de(e){const t=e?.host;return Boolean(t?.shadowRoot===e)}function ue(e){return Object.prototype.toString.call(e)==="[object ShadowRoot]"}function Ht(e){return e.includes(" background-clip: text;")&&!e.includes(" -webkit-background-clip: text;")&&(e=e.replace(" background-clip: text;"," -webkit-background-clip: text; background-clip: text;")),e}function Bt(e){const{cssText:t}=e;if(t.split('"').length<3)return t;const r=["@import",`url(${JSON.stringify(e.href)})`];return e.layerName===""?r.push("layer"):e.layerName&&r.push(`layer(${e.layerName})`),e.supportsText&&r.push(`supports(${e.supportsText})`),e.media.length&&r.push(e.media.mediaText),r.join(" ")+";"}function ge(e){try{const t=e.rules||e.cssRules;return t?Ht(Array.from(t,Ge).join("")):null}catch{return null}}function Ge(e){let t;if(Gt(e))try{t=ge(e.styleSheet)||Bt(e)}catch{}else if(qt(e)&&e.selectorText.includes(":"))return Vt(e.cssText);return t||e.cssText}function Vt(e){const t=/(\[(?:[\w-]+)[^\\])(:(?:[\w-]+)\])/gm;return e.replace(t,"$1\\$2")}function Gt(e){return"styleSheet"in e}function qt(e){return"selectorText"in e}class qe{constructor(){this.idNodeMap=new Map,this.nodeMetaMap=new WeakMap}getId(t){var r;if(!t)return-1;const n=(r=this.getMeta(t))===null||r===void 0?void 0:r.id;return n??-1}getNode(t){return this.idNodeMap.get(t)||null}getIds(){return Array.from(this.idNodeMap.keys())}getMeta(t){return this.nodeMetaMap.get(t)||null}removeNodeFromMap(t){const r=this.getId(t);this.idNodeMap.delete(r),t.childNodes&&t.childNodes.forEach(n=>this.removeNodeFromMap(n))}has(t){return this.idNodeMap.has(t)}hasNode(t){return this.nodeMetaMap.has(t)}add(t,r){const n=r.id;this.idNodeMap.set(n,t),this.nodeMetaMap.set(t,r)}replace(t,r){const n=this.getNode(t);if(n){const o=this.nodeMetaMap.get(n);o&&this.nodeMetaMap.set(r,o)}this.idNodeMap.set(t,r)}reset(){this.idNodeMap=new Map,this.nodeMetaMap=new WeakMap}}function Xt(){return new qe}function Ae({element:e,maskInputOptions:t,tagName:r,type:n,value:o,maskInputFn:a}){let l=o||"";const i=n&&K(n);return(t[r.toLowerCase()]||i&&t[i])&&(a?l=a(l,e):l="*".repeat(l.length)),l}function K(e){return e.toLowerCase()}const Xe="__rrweb_original__";function Yt(e){const t=e.getContext("2d");if(!t)return!0;const r=50;for(let n=0;n<e.width;n+=r)for(let o=0;o<e.height;o+=r){const a=t.getImageData,l=Xe in a?a[Xe]:a;if(new Uint32Array(l.call(t,n,o,Math.min(r,e.width-n),Math.min(r,e.height-o)).data.buffer).some(i=>i!==0))return!1}return!0}function Fe(e){const t=e.type;return e.hasAttribute("data-rr-is-password")?"password":t?K(t):null}function Ye(e,t){var r;let n;try{n=new URL(e,t??window.location.href)}catch{return null}const o=/\.([0-9a-z]+)(?:$)/i,a=n.pathname.match(o);return(r=a?.[1])!==null&&r!==void 0?r:null}let Jt=1;const Kt=new RegExp("[^a-z0-9-_:]"),pe=-2;function Je(){return Jt++}function Qt(e){if(e instanceof HTMLFormElement)return"form";const t=K(e.tagName);return Kt.test(t)?"div":t}function Zt(e){let t="";return e.indexOf("//")>-1?t=e.split("/").slice(0,3).join("/"):t=e.split("/")[0],t=t.split("?")[0],t}let re,Ke;const er=/url\((?:(')([^']*)'|(")(.*?)"|([^)]*))\)/gm,tr=/^(?:[a-z+]+:)?\/\//i,rr=/^www\..*/i,nr=/^(data:)([^,]*),(.*)/i;function Se(e,t){return(e||"").replace(er,(r,n,o,a,l,i)=>{const s=o||l||i,c=n||a||"";if(!s)return r;if(tr.test(s)||rr.test(s))return`url(${c}${s}${c})`;if(nr.test(s))return`url(${c}${s}${c})`;if(s[0]==="/")return`url(${c}${Zt(t)+s}${c})`;const d=t.split("/"),u=s.split("/");d.pop();for(const p of u)p!=="."&&(p===".."?d.pop():d.push(p));return`url(${c}${d.join("/")}${c})`})}const or=/^[^ \t\n\r\u000c]+/,sr=/^[, \t\n\r\u000c]+/;function ar(e,t){if(t.trim()==="")return t;let r=0;function n(a){let l;const i=a.exec(t.substring(r));return i?(l=i[0],r+=l.length,l):""}const o=[];for(;n(sr),!(r>=t.length);){let a=n(or);if(a.slice(-1)===",")a=be(e,a.substring(0,a.length-1)),o.push(a);else{let l="";a=be(e,a);let i=!1;for(;;){const s=t.charAt(r);if(s===""){o.push((a+l).trim());break}else if(i)s===")"&&(i=!1);else if(s===","){r+=1,o.push((a+l).trim());break}else s==="("&&(i=!0);l+=s,r+=1}}}return o.join(", ")}function be(e,t){if(!t||t.trim()==="")return t;const r=e.createElement("a");return r.href=t,r.href}function ir(e){return Boolean(e.tagName==="svg"||e.ownerSVGElement)}function _e(){const e=document.createElement("a");return e.href="",e.href}function Qe(e,t,r,n){return n&&(r==="src"||r==="href"&&!(t==="use"&&n[0]==="#")||r==="xlink:href"&&n[0]!=="#"||r==="background"&&(t==="table"||t==="td"||t==="th")?be(e,n):r==="srcset"?ar(e,n):r==="style"?Se(n,_e()):t==="object"&&r==="data"?be(e,n):n)}function Ze(e,t,r){return(e==="video"||e==="audio")&&t==="autoplay"}function lr(e,t,r){try{if(typeof t=="string"){if(e.classList.contains(t))return!0}else for(let n=e.classList.length;n--;){const o=e.classList[n];if(t.test(o))return!0}if(r)return e.matches(r)}catch{}return!1}function ve(e,t,r){if(!e)return!1;if(e.nodeType!==e.ELEMENT_NODE)return r?ve(e.parentNode,t,r):!1;for(let n=e.classList.length;n--;){const o=e.classList[n];if(t.test(o))return!0}return r?ve(e.parentNode,t,r):!1}function et(e,t,r,n){try{const o=e.nodeType===e.ELEMENT_NODE?e:e.parentElement;if(o===null)return!1;if(typeof t=="string"){if(n){if(o.closest(`.${t}`))return!0}else if(o.classList.contains(t))return!0}else if(ve(o,t,n))return!0;if(r){if(n){if(o.closest(r))return!0}else if(o.matches(r))return!0}}catch{}return!1}function cr(e,t,r){const n=e.contentWindow;if(!n)return;let o=!1,a;try{a=n.document.readyState}catch{return}if(a!=="complete"){const i=setTimeout(()=>{o||(t(),o=!0)},r);e.addEventListener("load",()=>{clearTimeout(i),o=!0,t()});return}const l="about:blank";if(n.location.href!==l||e.src===l||e.src==="")return setTimeout(t,0),e.addEventListener("load",t);e.addEventListener("load",t)}function dr(e,t,r){let n=!1,o;try{o=e.sheet}catch{return}if(o)return;const a=setTimeout(()=>{n||(t(),n=!0)},r);e.addEventListener("load",()=>{clearTimeout(a),n=!0,t()})}function ur(e,t){const{doc:r,mirror:n,blockClass:o,blockSelector:a,needsMask:l,inlineStylesheet:i,maskInputOptions:s={},maskTextFn:c,maskInputFn:d,dataURLOptions:u={},inlineImages:p,recordCanvas:m,keepIframeSrcFn:f,newlyAddedElement:h=!1}=t,y=pr(r,n);switch(e.nodeType){case e.DOCUMENT_NODE:return e.compatMode!=="CSS1Compat"?{type:L.Document,childNodes:[],compatMode:e.compatMode}:{type:L.Document,childNodes:[]};case e.DOCUMENT_TYPE_NODE:return{type:L.DocumentType,name:e.name,publicId:e.publicId,systemId:e.systemId,rootId:y};case e.ELEMENT_NODE:return mr(e,{doc:r,blockClass:o,blockSelector:a,inlineStylesheet:i,maskInputOptions:s,maskInputFn:d,dataURLOptions:u,inlineImages:p,recordCanvas:m,keepIframeSrcFn:f,newlyAddedElement:h,rootId:y});case e.TEXT_NODE:return hr(e,{needsMask:l,maskTextFn:c,rootId:y});case e.CDATA_SECTION_NODE:return{type:L.CDATA,textContent:"",rootId:y};case e.COMMENT_NODE:return{type:L.Comment,textContent:e.textContent||"",rootId:y};default:return!1}}function pr(e,t){if(!t.hasNode(e))return;const r=t.getId(e);return r===1?void 0:r}function hr(e,t){var r;const{needsMask:n,maskTextFn:o,rootId:a}=t,l=e.parentNode&&e.parentNode.tagName;let i=e.textContent;const s=l==="STYLE"?!0:void 0,c=l==="SCRIPT"?!0:void 0;if(s&&i){try{e.nextSibling||e.previousSibling||!((r=e.parentNode.sheet)===null||r===void 0)&&r.cssRules&&(i=ge(e.parentNode.sheet))}catch(d){console.warn(`Cannot get CSS styles from text's parentNode. Error: ${d}`,e)}i=Se(i,_e())}return c&&(i="SCRIPT_PLACEHOLDER"),!s&&!c&&i&&n&&(i=o?o(i,e.parentElement):i.replace(/[\S]/g,"*")),{type:L.Text,textContent:i||"",isStyle:s,rootId:a}}function mr(e,t){const{doc:r,blockClass:n,blockSelector:o,inlineStylesheet:a,maskInputOptions:l={},maskInputFn:i,dataURLOptions:s={},inlineImages:c,recordCanvas:d,keepIframeSrcFn:u,newlyAddedElement:p=!1,rootId:m}=t,f=lr(e,n,o),h=Qt(e);let y={};const S=e.attributes.length;for(let g=0;g<S;g++){const v=e.attributes[g];Ze(h,v.name,v.value)||(y[v.name]=Qe(r,h,K(v.name),v.value))}if(h==="link"&&a){const g=Array.from(r.styleSheets).find(x=>x.href===e.href);let v=null;g&&(v=ge(g)),v&&(delete y.rel,delete y.href,y._cssText=Se(v,g.href))}if(h==="style"&&e.sheet&&!(e.innerText||e.textContent||"").trim().length){const g=ge(e.sheet);g&&(y._cssText=Se(g,_e()))}if(h==="input"||h==="textarea"||h==="select"){const g=e.value,v=e.checked;y.type!=="radio"&&y.type!=="checkbox"&&y.type!=="submit"&&y.type!=="button"&&g?y.value=Ae({element:e,type:Fe(e),tagName:h,value:g,maskInputOptions:l,maskInputFn:i}):v&&(y.checked=v)}if(h==="option"&&(e.selected&&!l.select?y.selected=!0:delete y.selected),h==="canvas"&&d){if(e.__context==="2d")Yt(e)||(y.rr_dataURL=e.toDataURL(s.type,s.quality));else if(!("__context"in e)){const g=e.toDataURL(s.type,s.quality),v=document.createElement("canvas");v.width=e.width,v.height=e.height;const x=v.toDataURL(s.type,s.quality);g!==x&&(y.rr_dataURL=g)}}if(h==="img"&&c){re||(re=r.createElement("canvas"),Ke=re.getContext("2d"));const g=e,v=g.crossOrigin;g.crossOrigin="anonymous";const x=()=>{g.removeEventListener("load",x);try{re.width=g.naturalWidth,re.height=g.naturalHeight,Ke.drawImage(g,0,0),y.rr_dataURL=re.toDataURL(s.type,s.quality)}catch(D){console.warn(`Cannot inline img src=${g.currentSrc}! Error: ${D}`)}v?y.crossOrigin=v:g.removeAttribute("crossorigin")};g.complete&&g.naturalWidth!==0?x():g.addEventListener("load",x)}if((h==="audio"||h==="video")&&(y.rr_mediaState=e.paused?"paused":"played",y.rr_mediaCurrentTime=e.currentTime),p||(e.scrollLeft&&(y.rr_scrollLeft=e.scrollLeft),e.scrollTop&&(y.rr_scrollTop=e.scrollTop)),f){const{width:g,height:v}=e.getBoundingClientRect();y={class:y.class,rr_width:`${g}px`,rr_height:`${v}px`}}h==="iframe"&&!u(y.src)&&(e.contentDocument||(y.rr_src=y.src),delete y.src);let b;try{customElements.get(h)&&(b=!0)}catch{}return{type:L.Element,tagName:h,attributes:y,childNodes:[],isSVG:ir(e)||void 0,needBlock:f,rootId:m,isCustom:b}}function O(e){return e==null?"":e.toLowerCase()}function fr(e,t){return!!(t.comment&&e.type===L.Comment||e.type===L.Element&&(t.script&&(e.tagName==="script"||e.tagName==="link"&&(e.attributes.rel==="preload"||e.attributes.rel==="modulepreload")&&e.attributes.as==="script"||e.tagName==="link"&&e.attributes.rel==="prefetch"&&typeof e.attributes.href=="string"&&Ye(e.attributes.href)==="js")||t.headFavicon&&(e.tagName==="link"&&e.attributes.rel==="shortcut icon"||e.tagName==="meta"&&(O(e.attributes.name).match(/^msapplication-tile(image|color)$/)||O(e.attributes.name)==="application-name"||O(e.attributes.rel)==="icon"||O(e.attributes.rel)==="apple-touch-icon"||O(e.attributes.rel)==="shortcut icon"))||e.tagName==="meta"&&(t.headMetaDescKeywords&&O(e.attributes.name).match(/^description|keywords$/)||t.headMetaSocial&&(O(e.attributes.property).match(/^(og|twitter|fb):/)||O(e.attributes.name).match(/^(og|twitter):/)||O(e.attributes.name)==="pinterest")||t.headMetaRobots&&(O(e.attributes.name)==="robots"||O(e.attributes.name)==="googlebot"||O(e.attributes.name)==="bingbot")||t.headMetaHttpEquiv&&e.attributes["http-equiv"]!==void 0||t.headMetaAuthorship&&(O(e.attributes.name)==="author"||O(e.attributes.name)==="generator"||O(e.attributes.name)==="framework"||O(e.attributes.name)==="publisher"||O(e.attributes.name)==="progid"||O(e.attributes.property).match(/^article:/)||O(e.attributes.property).match(/^product:/))||t.headMetaVerification&&(O(e.attributes.name)==="google-site-verification"||O(e.attributes.name)==="yandex-verification"||O(e.attributes.name)==="csrf-token"||O(e.attributes.name)==="p:domain_verify"||O(e.attributes.name)==="verify-v1"||O(e.attributes.name)==="verification"||O(e.attributes.name)==="shopify-checkout-api-token"))))}function ne(e,t){const{doc:r,mirror:n,blockClass:o,blockSelector:a,maskTextClass:l,maskTextSelector:i,skipChild:s=!1,inlineStylesheet:c=!0,maskInputOptions:d={},maskTextFn:u,maskInputFn:p,slimDOMOptions:m,dataURLOptions:f={},inlineImages:h=!1,recordCanvas:y=!1,onSerialize:S,onIframeLoad:b,iframeLoadTimeout:g=5e3,onStylesheetLoad:v,stylesheetLoadTimeout:x=5e3,keepIframeSrcFn:D=()=>!1,newlyAddedElement:V=!1}=t;let{needsMask:U}=t,{preserveWhiteSpace:z=!0}=t;!U&&e.childNodes&&(U=et(e,l,i,U===void 0));const H=ur(e,{doc:r,mirror:n,blockClass:o,blockSelector:a,needsMask:U,inlineStylesheet:c,maskInputOptions:d,maskTextFn:u,maskInputFn:p,dataURLOptions:f,inlineImages:h,recordCanvas:y,keepIframeSrcFn:D,newlyAddedElement:V});if(!H)return console.warn(e,"not serialized"),null;let X;n.hasNode(e)?X=n.getId(e):fr(H,m)||!z&&H.type===L.Text&&!H.isStyle&&!H.textContent.replace(/^\s+|\s+$/gm,"").length?X=pe:X=Je();const k=Object.assign(H,{id:X});if(n.add(e,k),X===pe)return null;S&&S(e);let Z=!s;if(k.type===L.Element){Z=Z&&!k.needBlock,delete k.needBlock;const $=e.shadowRoot;$&&ue($)&&(k.isShadowHost=!0)}if((k.type===L.Document||k.type===L.Element)&&Z){m.headWhitespace&&k.type===L.Element&&k.tagName==="head"&&(z=!1);const $={doc:r,mirror:n,blockClass:o,blockSelector:a,needsMask:U,maskTextClass:l,maskTextSelector:i,skipChild:s,inlineStylesheet:c,maskInputOptions:d,maskTextFn:u,maskInputFn:p,slimDOMOptions:m,dataURLOptions:f,inlineImages:h,recordCanvas:y,preserveWhiteSpace:z,onSerialize:S,onIframeLoad:b,iframeLoadTimeout:g,onStylesheetLoad:v,stylesheetLoadTimeout:x,keepIframeSrcFn:D};if(!(k.type===L.Element&&k.tagName==="textarea"&&k.attributes.value!==void 0))for(const J of Array.from(e.childNodes)){const G=ne(J,$);G&&k.childNodes.push(G)}if(zt(e)&&e.shadowRoot)for(const J of Array.from(e.shadowRoot.childNodes)){const G=ne(J,$);G&&(ue(e.shadowRoot)&&(G.isShadow=!0),k.childNodes.push(G))}}return e.parentNode&&de(e.parentNode)&&ue(e.parentNode)&&(k.isShadow=!0),k.type===L.Element&&k.tagName==="iframe"&&cr(e,()=>{const $=e.contentDocument;if($&&b){const J=ne($,{doc:$,mirror:n,blockClass:o,blockSelector:a,needsMask:U,maskTextClass:l,maskTextSelector:i,skipChild:!1,inlineStylesheet:c,maskInputOptions:d,maskTextFn:u,maskInputFn:p,slimDOMOptions:m,dataURLOptions:f,inlineImages:h,recordCanvas:y,preserveWhiteSpace:z,onSerialize:S,onIframeLoad:b,iframeLoadTimeout:g,onStylesheetLoad:v,stylesheetLoadTimeout:x,keepIframeSrcFn:D});J&&b(e,J)}},g),k.type===L.Element&&k.tagName==="link"&&typeof k.attributes.rel=="string"&&(k.attributes.rel==="stylesheet"||k.attributes.rel==="preload"&&typeof k.attributes.href=="string"&&Ye(k.attributes.href)==="css")&&dr(e,()=>{if(v){const $=ne(e,{doc:r,mirror:n,blockClass:o,blockSelector:a,needsMask:U,maskTextClass:l,maskTextSelector:i,skipChild:!1,inlineStylesheet:c,maskInputOptions:d,maskTextFn:u,maskInputFn:p,slimDOMOptions:m,dataURLOptions:f,inlineImages:h,recordCanvas:y,preserveWhiteSpace:z,onSerialize:S,onIframeLoad:b,iframeLoadTimeout:g,onStylesheetLoad:v,stylesheetLoadTimeout:x,keepIframeSrcFn:D});$&&v(e,$)}},x),k}function yr(e,t){const{mirror:r=new qe,blockClass:n="rr-block",blockSelector:o=null,maskTextClass:a="rr-mask",maskTextSelector:l=null,inlineStylesheet:i=!0,inlineImages:s=!1,recordCanvas:c=!1,maskAllInputs:d=!1,maskTextFn:u,maskInputFn:p,slimDOM:m=!1,dataURLOptions:f,preserveWhiteSpace:h,onSerialize:y,onIframeLoad:S,iframeLoadTimeout:b,onStylesheetLoad:g,stylesheetLoadTimeout:v,keepIframeSrcFn:x=()=>!1}=t||{};return ne(e,{doc:e,mirror:r,blockClass:n,blockSelector:o,maskTextClass:a,maskTextSelector:l,skipChild:!1,inlineStylesheet:i,maskInputOptions:d===!0?{color:!0,date:!0,"datetime-local":!0,email:!0,month:!0,number:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0,textarea:!0,select:!0,password:!0}:d===!1?{password:!0}:d,maskTextFn:u,maskInputFn:p,slimDOMOptions:m===!0||m==="all"?{script:!0,comment:!0,headFavicon:!0,headWhitespace:!0,headMetaDescKeywords:m==="all",headMetaSocial:!0,headMetaRobots:!0,headMetaHttpEquiv:!0,headMetaAuthorship:!0,headMetaVerification:!0}:m===!1?{}:m,dataURLOptions:f,inlineImages:s,recordCanvas:c,preserveWhiteSpace:h,onSerialize:y,onIframeLoad:S,iframeLoadTimeout:b,onStylesheetLoad:g,stylesheetLoadTimeout:v,keepIframeSrcFn:x,newlyAddedElement:!1})}function A(e,t,r=document){const n={capture:!0,passive:!0};return r.addEventListener(e,t,n),()=>r.removeEventListener(e,t,n)}const oe=`Please stop import mirror directly. Instead of that,\r
now you can use replayer.getMirror() to access the mirror instance of a replayer,\r
or you can use record.mirror to access the mirror instance during recording.`;let tt={map:{},getId(){return console.error(oe),-1},getNode(){return console.error(oe),null},removeNodeFromMap(){console.error(oe)},has(){return console.error(oe),!1},reset(){console.error(oe)}};typeof window<"u"&&window.Proxy&&window.Reflect&&(tt=new Proxy(tt,{get(e,t,r){return t==="map"&&console.error(oe),Reflect.get(e,t,r)}}));function he(e,t,r={}){let n=null,o=0;return function(...a){const l=Date.now();!o&&r.leading===!1&&(o=l);const i=t-(l-o),s=this;i<=0||i>t?(n&&(clearTimeout(n),n=null),o=l,e.apply(s,a)):!n&&r.trailing!==!1&&(n=setTimeout(()=>{o=r.leading===!1?0:Date.now(),n=null,e.apply(s,a)},i))}}function we(e,t,r,n,o=window){const a=o.Object.getOwnPropertyDescriptor(e,t);return o.Object.defineProperty(e,t,n?r:{set(l){setTimeout(()=>{r.set.call(this,l)},0),a&&a.set&&a.set.call(this,l)}}),()=>we(e,t,a||{},!0)}function se(e,t,r){try{if(!(t in e))return()=>{};const n=e[t],o=r(n);return typeof o=="function"&&(o.prototype=o.prototype||{},Object.defineProperties(o,{__rrweb_original__:{enumerable:!1,value:n}})),e[t]=o,()=>{e[t]=n}}catch{return()=>{}}}let Ie=Date.now;/[1-9][0-9]{12}/.test(Date.now().toString())||(Ie=()=>new Date().getTime());function rt(e){var t,r,n,o,a,l;const i=e.document;return{left:i.scrollingElement?i.scrollingElement.scrollLeft:e.pageXOffset!==void 0?e.pageXOffset:i?.documentElement.scrollLeft||((r=(t=i?.body)==null?void 0:t.parentElement)==null?void 0:r.scrollLeft)||((n=i?.body)==null?void 0:n.scrollLeft)||0,top:i.scrollingElement?i.scrollingElement.scrollTop:e.pageYOffset!==void 0?e.pageYOffset:i?.documentElement.scrollTop||((a=(o=i?.body)==null?void 0:o.parentElement)==null?void 0:a.scrollTop)||((l=i?.body)==null?void 0:l.scrollTop)||0}}function nt(){return window.innerHeight||document.documentElement&&document.documentElement.clientHeight||document.body&&document.body.clientHeight}function ot(){return window.innerWidth||document.documentElement&&document.documentElement.clientWidth||document.body&&document.body.clientWidth}function st(e){return e?e.nodeType===e.ELEMENT_NODE?e:e.parentElement:null}function F(e,t,r,n){if(!e)return!1;const o=st(e);if(!o)return!1;try{if(typeof t=="string"){if(o.classList.contains(t)||n&&o.closest("."+t)!==null)return!0}else if(ve(o,t,n))return!0}catch{}return!!(r&&(o.matches(r)||n&&o.closest(r)!==null))}function gr(e,t){return t.getId(e)!==-1}function Pe(e,t){return t.getId(e)===pe}function at(e,t){if(de(e))return!1;const r=t.getId(e);return t.has(r)?e.parentNode&&e.parentNode.nodeType===e.DOCUMENT_NODE?!1:e.parentNode?at(e.parentNode,t):!0:!0}function We(e){return Boolean(e.changedTouches)}function Sr(e=window){"NodeList"in e&&!e.NodeList.prototype.forEach&&(e.NodeList.prototype.forEach=Array.prototype.forEach),"DOMTokenList"in e&&!e.DOMTokenList.prototype.forEach&&(e.DOMTokenList.prototype.forEach=Array.prototype.forEach),Node.prototype.contains||(Node.prototype.contains=(...t)=>{let r=t[0];if(!(0 in t))throw new TypeError("1 argument is required");do if(this===r)return!0;while(r=r&&r.parentNode);return!1})}function it(e,t){return Boolean(e.nodeName==="IFRAME"&&t.getMeta(e))}function lt(e,t){return Boolean(e.nodeName==="LINK"&&e.nodeType===e.ELEMENT_NODE&&e.getAttribute&&e.getAttribute("rel")==="stylesheet"&&t.getMeta(e))}function $e(e){return Boolean(e?.shadowRoot)}class br{constructor(){this.id=1,this.styleIDMap=new WeakMap,this.idStyleMap=new Map}getId(t){var r;return(r=this.styleIDMap.get(t))!=null?r:-1}has(t){return this.styleIDMap.has(t)}add(t,r){if(this.has(t))return this.getId(t);let n;return r===void 0?n=this.id++:n=r,this.styleIDMap.set(t,n),this.idStyleMap.set(n,t),n}getStyle(t){return this.idStyleMap.get(t)||null}reset(){this.styleIDMap=new WeakMap,this.idStyleMap=new Map,this.id=1}generateId(){return this.id++}}function ct(e){var t,r;let n=null;return((r=(t=e.getRootNode)==null?void 0:t.call(e))==null?void 0:r.nodeType)===Node.DOCUMENT_FRAGMENT_NODE&&e.getRootNode().host&&(n=e.getRootNode().host),n}function vr(e){let t=e,r;for(;r=ct(t);)t=r;return t}function wr(e){const t=e.ownerDocument;if(!t)return!1;const r=vr(e);return t.contains(r)}function dt(e){const t=e.ownerDocument;return t?t.contains(e)||wr(e):!1}var C=(e=>(e[e.DomContentLoaded=0]="DomContentLoaded",e[e.Load=1]="Load",e[e.FullSnapshot=2]="FullSnapshot",e[e.IncrementalSnapshot=3]="IncrementalSnapshot",e[e.Meta=4]="Meta",e[e.Custom=5]="Custom",e[e.Plugin=6]="Plugin",e))(C||{}),I=(e=>(e[e.Mutation=0]="Mutation",e[e.MouseMove=1]="MouseMove",e[e.MouseInteraction=2]="MouseInteraction",e[e.Scroll=3]="Scroll",e[e.ViewportResize=4]="ViewportResize",e[e.Input=5]="Input",e[e.TouchMove=6]="TouchMove",e[e.MediaInteraction=7]="MediaInteraction",e[e.StyleSheetRule=8]="StyleSheetRule",e[e.CanvasMutation=9]="CanvasMutation",e[e.Font=10]="Font",e[e.Log=11]="Log",e[e.Drag=12]="Drag",e[e.StyleDeclaration=13]="StyleDeclaration",e[e.Selection=14]="Selection",e[e.AdoptedStyleSheet=15]="AdoptedStyleSheet",e[e.CustomElement=16]="CustomElement",e))(I||{}),P=(e=>(e[e.MouseUp=0]="MouseUp",e[e.MouseDown=1]="MouseDown",e[e.Click=2]="Click",e[e.ContextMenu=3]="ContextMenu",e[e.DblClick=4]="DblClick",e[e.Focus=5]="Focus",e[e.Blur=6]="Blur",e[e.TouchStart=7]="TouchStart",e[e.TouchMove_Departed=8]="TouchMove_Departed",e[e.TouchEnd=9]="TouchEnd",e[e.TouchCancel=10]="TouchCancel",e))(P||{}),q=(e=>(e[e.Mouse=0]="Mouse",e[e.Pen=1]="Pen",e[e.Touch=2]="Touch",e))(q||{}),ae=(e=>(e[e["2D"]=0]="2D",e[e.WebGL=1]="WebGL",e[e.WebGL2=2]="WebGL2",e))(ae||{}),ie=(e=>(e[e.Play=0]="Play",e[e.Pause=1]="Pause",e[e.Seeked=2]="Seeked",e[e.VolumeChange=3]="VolumeChange",e[e.RateChange=4]="RateChange",e))(ie||{}),Ir=(e=>(e.Start="start",e.Pause="pause",e.Resume="resume",e.Resize="resize",e.Finish="finish",e.FullsnapshotRebuilded="fullsnapshot-rebuilded",e.LoadStylesheetStart="load-stylesheet-start",e.LoadStylesheetEnd="load-stylesheet-end",e.SkipStart="skip-start",e.SkipEnd="skip-end",e.MouseInteraction="mouse-interaction",e.EventCast="event-cast",e.CustomEvent="custom-event",e.Flush="flush",e.StateChange="state-change",e.PlayBack="play-back",e.Destroy="destroy",e))(Ir||{});function ut(e){return"__ln"in e}class Mr{constructor(){this.length=0,this.head=null,this.tail=null}get(t){if(t>=this.length)throw new Error("Position outside of list range");let r=this.head;for(let n=0;n<t;n++)r=r?.next||null;return r}addNode(t){const r={value:t,previous:null,next:null};if(t.__ln=r,t.previousSibling&&ut(t.previousSibling)){const n=t.previousSibling.__ln.next;r.next=n,r.previous=t.previousSibling.__ln,t.previousSibling.__ln.next=r,n&&(n.previous=r)}else if(t.nextSibling&&ut(t.nextSibling)&&t.nextSibling.__ln.previous){const n=t.nextSibling.__ln.previous;r.previous=n,r.next=t.nextSibling.__ln,t.nextSibling.__ln.previous=r,n&&(n.next=r)}else this.head&&(this.head.previous=r),r.next=this.head,this.head=r;r.next===null&&(this.tail=r),this.length++}removeNode(t){const r=t.__ln;!this.head||(r.previous?(r.previous.next=r.next,r.next?r.next.previous=r.previous:this.tail=r.previous):(this.head=r.next,this.head?this.head.previous=null:this.tail=null),t.__ln&&delete t.__ln,this.length--)}}const pt=(e,t)=>`${e}@${t}`;class Cr{constructor(){this.frozen=!1,this.locked=!1,this.texts=[],this.attributes=[],this.attributeMap=new WeakMap,this.removes=[],this.mapRemoves=[],this.movedMap={},this.addedSet=new Set,this.movedSet=new Set,this.droppedSet=new Set,this.processMutations=t=>{t.forEach(this.processMutation),this.emit()},this.emit=()=>{if(this.frozen||this.locked)return;const t=[],r=new Set,n=new Mr,o=s=>{let c=s,d=pe;for(;d===pe;)c=c&&c.nextSibling,d=c&&this.mirror.getId(c);return d},a=s=>{if(!s.parentNode||!dt(s)||s.parentNode.tagName==="TEXTAREA")return;const c=de(s.parentNode)?this.mirror.getId(ct(s)):this.mirror.getId(s.parentNode),d=o(s);if(c===-1||d===-1)return n.addNode(s);const u=ne(s,{doc:this.doc,mirror:this.mirror,blockClass:this.blockClass,blockSelector:this.blockSelector,maskTextClass:this.maskTextClass,maskTextSelector:this.maskTextSelector,skipChild:!0,newlyAddedElement:!0,inlineStylesheet:this.inlineStylesheet,maskInputOptions:this.maskInputOptions,maskTextFn:this.maskTextFn,maskInputFn:this.maskInputFn,slimDOMOptions:this.slimDOMOptions,dataURLOptions:this.dataURLOptions,recordCanvas:this.recordCanvas,inlineImages:this.inlineImages,onSerialize:p=>{it(p,this.mirror)&&this.iframeManager.addIframe(p),lt(p,this.mirror)&&this.stylesheetManager.trackLinkElement(p),$e(s)&&this.shadowDomManager.addShadowRoot(s.shadowRoot,this.doc)},onIframeLoad:(p,m)=>{this.iframeManager.attachIframe(p,m),p.contentWindow&&this.canvasManager.addWindow(p.contentWindow),this.shadowDomManager.observeAttachShadow(p)},onStylesheetLoad:(p,m)=>{this.stylesheetManager.attachLinkElement(p,m)}});u&&(t.push({parentId:c,nextId:d,node:u}),r.add(u.id))};for(;this.mapRemoves.length;)this.mirror.removeNodeFromMap(this.mapRemoves.shift());for(const s of this.movedSet)ht(this.removes,s,this.mirror)&&!this.movedSet.has(s.parentNode)||a(s);for(const s of this.addedSet)!ft(this.droppedSet,s)&&!ht(this.removes,s,this.mirror)||ft(this.movedSet,s)?a(s):this.droppedSet.add(s);let l=null;for(;n.length;){let s=null;if(l){const c=this.mirror.getId(l.value.parentNode),d=o(l.value);c!==-1&&d!==-1&&(s=l)}if(!s){let c=n.tail;for(;c;){const d=c;if(c=c.previous,d){const u=this.mirror.getId(d.value.parentNode);if(o(d.value)===-1)continue;if(u!==-1){s=d;break}else{const p=d.value;if(p.parentNode&&p.parentNode.nodeType===Node.DOCUMENT_FRAGMENT_NODE){const m=p.parentNode.host;if(this.mirror.getId(m)!==-1){s=d;break}}}}}}if(!s){for(;n.head;)n.removeNode(n.head.value);break}l=s.previous,n.removeNode(s.value),a(s.value)}const i={texts:this.texts.map(s=>{const c=s.node;return c.parentNode.tagName==="TEXTAREA"&&this.genTextAreaValueMutation(c.parentNode),{id:this.mirror.getId(c),value:s.value}}).filter(s=>!r.has(s.id)).filter(s=>this.mirror.has(s.id)),attributes:this.attributes.map(s=>{const{attributes:c}=s;if(typeof c.style=="string"){const d=JSON.stringify(s.styleDiff),u=JSON.stringify(s._unchangedStyles);d.length<c.style.length&&(d+u).split("var(").length===c.style.split("var(").length&&(c.style=s.styleDiff)}return{id:this.mirror.getId(s.node),attributes:c}}).filter(s=>!r.has(s.id)).filter(s=>this.mirror.has(s.id)),removes:this.removes,adds:t};!i.texts.length&&!i.attributes.length&&!i.removes.length&&!i.adds.length||(this.texts=[],this.attributes=[],this.attributeMap=new WeakMap,this.removes=[],this.addedSet=new Set,this.movedSet=new Set,this.droppedSet=new Set,this.movedMap={},this.mutationCb(i))},this.genTextAreaValueMutation=t=>{let r=this.attributeMap.get(t);r||(r={node:t,attributes:{},styleDiff:{},_unchangedStyles:{}},this.attributes.push(r),this.attributeMap.set(t,r)),r.attributes.value=Array.from(t.childNodes,n=>n.textContent||"").join("")},this.processMutation=t=>{if(!Pe(t.target,this.mirror))switch(t.type){case"characterData":{const r=t.target.textContent;!F(t.target,this.blockClass,this.blockSelector,!1)&&r!==t.oldValue&&this.texts.push({value:et(t.target,this.maskTextClass,this.maskTextSelector,!0)&&r?this.maskTextFn?this.maskTextFn(r,st(t.target)):r.replace(/[\S]/g,"*"):r,node:t.target});break}case"attributes":{const r=t.target;let n=t.attributeName,o=t.target.getAttribute(n);if(n==="value"){const l=Fe(r);o=Ae({element:r,maskInputOptions:this.maskInputOptions,tagName:r.tagName,type:l,value:o,maskInputFn:this.maskInputFn})}if(F(t.target,this.blockClass,this.blockSelector,!1)||o===t.oldValue)return;let a=this.attributeMap.get(t.target);if(r.tagName==="IFRAME"&&n==="src"&&!this.keepIframeSrcFn(o))if(!r.contentDocument)n="rr_src";else return;if(a||(a={node:t.target,attributes:{},styleDiff:{},_unchangedStyles:{}},this.attributes.push(a),this.attributeMap.set(t.target,a)),n==="type"&&r.tagName==="INPUT"&&(t.oldValue||"").toLowerCase()==="password"&&r.setAttribute("data-rr-is-password","true"),!Ze(r.tagName,n)&&(a.attributes[n]=Qe(this.doc,K(r.tagName),K(n),o),n==="style")){if(!this.unattachedDoc)try{this.unattachedDoc=document.implementation.createHTMLDocument()}catch{this.unattachedDoc=this.doc}const l=this.unattachedDoc.createElement("span");t.oldValue&&l.setAttribute("style",t.oldValue);for(const i of Array.from(r.style)){const s=r.style.getPropertyValue(i),c=r.style.getPropertyPriority(i);s!==l.style.getPropertyValue(i)||c!==l.style.getPropertyPriority(i)?c===""?a.styleDiff[i]=s:a.styleDiff[i]=[s,c]:a._unchangedStyles[i]=[s,c]}for(const i of Array.from(l.style))r.style.getPropertyValue(i)===""&&(a.styleDiff[i]=!1)}break}case"childList":{if(F(t.target,this.blockClass,this.blockSelector,!0))return;if(t.target.tagName==="TEXTAREA"){this.genTextAreaValueMutation(t.target);return}t.addedNodes.forEach(r=>this.genAdds(r,t.target)),t.removedNodes.forEach(r=>{const n=this.mirror.getId(r),o=de(t.target)?this.mirror.getId(t.target.host):this.mirror.getId(t.target);F(t.target,this.blockClass,this.blockSelector,!1)||Pe(r,this.mirror)||!gr(r,this.mirror)||(this.addedSet.has(r)?(Ue(this.addedSet,r),this.droppedSet.add(r)):this.addedSet.has(t.target)&&n===-1||at(t.target,this.mirror)||(this.movedSet.has(r)&&this.movedMap[pt(n,o)]?Ue(this.movedSet,r):this.removes.push({parentId:o,id:n,isShadow:de(t.target)&&ue(t.target)?!0:void 0})),this.mapRemoves.push(r))});break}}},this.genAdds=(t,r)=>{if(!this.processedNodeManager.inOtherBuffer(t,this)&&!(this.addedSet.has(t)||this.movedSet.has(t))){if(this.mirror.hasNode(t)){if(Pe(t,this.mirror))return;this.movedSet.add(t);let n=null;r&&this.mirror.hasNode(r)&&(n=this.mirror.getId(r)),n&&n!==-1&&(this.movedMap[pt(this.mirror.getId(t),n)]=!0)}else this.addedSet.add(t),this.droppedSet.delete(t);F(t,this.blockClass,this.blockSelector,!1)||(t.childNodes.forEach(n=>this.genAdds(n)),$e(t)&&t.shadowRoot.childNodes.forEach(n=>{this.processedNodeManager.add(n,this),this.genAdds(n,t)}))}}}init(t){["mutationCb","blockClass","blockSelector","maskTextClass","maskTextSelector","inlineStylesheet","maskInputOptions","maskTextFn","maskInputFn","keepIframeSrcFn","recordCanvas","inlineImages","slimDOMOptions","dataURLOptions","doc","mirror","iframeManager","stylesheetManager","shadowDomManager","canvasManager","processedNodeManager"].forEach(r=>{this[r]=t[r]})}freeze(){this.frozen=!0,this.canvasManager.freeze()}unfreeze(){this.frozen=!1,this.canvasManager.unfreeze(),this.emit()}isFrozen(){return this.frozen}lock(){this.locked=!0,this.canvasManager.lock()}unlock(){this.locked=!1,this.canvasManager.unlock(),this.emit()}reset(){this.shadowDomManager.reset(),this.canvasManager.reset()}}function Ue(e,t){e.delete(t),t.childNodes.forEach(r=>Ue(e,r))}function ht(e,t,r){return e.length===0?!1:mt(e,t,r)}function mt(e,t,r){const{parentNode:n}=t;if(!n)return!1;const o=r.getId(n);return e.some(a=>a.id===o)?!0:mt(e,n,r)}function ft(e,t){return e.size===0?!1:yt(e,t)}function yt(e,t){const{parentNode:r}=t;return r?e.has(r)?!0:yt(e,r):!1}let me;function kr(e){me=e}function Or(){me=void 0}const M=e=>me?(...t)=>{try{return e(...t)}catch(r){if(me&&me(r)===!0)return;throw r}}:e;var Tr=Object.defineProperty,Er=Object.defineProperties,Rr=Object.getOwnPropertyDescriptors,gt=Object.getOwnPropertySymbols,xr=Object.prototype.hasOwnProperty,Lr=Object.prototype.propertyIsEnumerable,St=(e,t,r)=>t in e?Tr(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,bt=(e,t)=>{for(var r in t||(t={}))xr.call(t,r)&&St(e,r,t[r]);if(gt)for(var r of gt(t))Lr.call(t,r)&&St(e,r,t[r]);return e},Nr=(e,t)=>Er(e,Rr(t));const Q=[];function fe(e){try{if("composedPath"in e){const t=e.composedPath();if(t.length)return t[0]}else if("path"in e&&e.path.length)return e.path[0]}catch{}return e&&e.target}function vt(e,t){var r,n;const o=new Cr;Q.push(o),o.init(e);let a=window.MutationObserver||window.__rrMutationObserver;const l=(n=(r=window?.Zone)==null?void 0:r.__symbol__)==null?void 0:n.call(r,"MutationObserver");l&&window[l]&&(a=window[l]);const i=new a(M(o.processMutations.bind(o)));return i.observe(t,{attributes:!0,attributeOldValue:!0,characterData:!0,characterDataOldValue:!0,childList:!0,subtree:!0}),i}function Dr({mousemoveCb:e,sampling:t,doc:r,mirror:n}){if(t.mousemove===!1)return()=>{};const o=typeof t.mousemove=="number"?t.mousemove:50,a=typeof t.mousemoveCallback=="number"?t.mousemoveCallback:500;let l=[],i;const s=he(M(u=>{const p=Date.now()-i;e(l.map(m=>(m.timeOffset-=p,m)),u),l=[],i=null}),a),c=M(he(M(u=>{const p=fe(u),{clientX:m,clientY:f}=We(u)?u.changedTouches[0]:u;i||(i=Ie()),l.push({x:m,y:f,id:n.getId(p),timeOffset:Ie()-i}),s(typeof DragEvent<"u"&&u instanceof DragEvent?I.Drag:u instanceof MouseEvent?I.MouseMove:I.TouchMove)}),o,{trailing:!1})),d=[A("mousemove",c,r),A("touchmove",c,r),A("drag",c,r)];return M(()=>{d.forEach(u=>u())})}function Ar({mouseInteractionCb:e,doc:t,mirror:r,blockClass:n,blockSelector:o,sampling:a}){if(a.mouseInteraction===!1)return()=>{};const l=a.mouseInteraction===!0||a.mouseInteraction===void 0?{}:a.mouseInteraction,i=[];let s=null;const c=d=>u=>{const p=fe(u);if(F(p,n,o,!0))return;let m=null,f=d;if("pointerType"in u){switch(u.pointerType){case"mouse":m=q.Mouse;break;case"touch":m=q.Touch;break;case"pen":m=q.Pen;break}m===q.Touch?P[d]===P.MouseDown?f="TouchStart":P[d]===P.MouseUp&&(f="TouchEnd"):q.Pen}else We(u)&&(m=q.Touch);m!==null?(s=m,(f.startsWith("Touch")&&m===q.Touch||f.startsWith("Mouse")&&m===q.Mouse)&&(m=null)):P[d]===P.Click&&(m=s,s=null);const h=We(u)?u.changedTouches[0]:u;if(!h)return;const y=r.getId(p),{clientX:S,clientY:b}=h;M(e)(bt({type:P[f],id:y,x:S,y:b},m!==null&&{pointerType:m}))};return Object.keys(P).filter(d=>Number.isNaN(Number(d))&&!d.endsWith("_Departed")&&l[d]!==!1).forEach(d=>{let u=K(d);const p=c(d);if(window.PointerEvent)switch(P[d]){case P.MouseDown:case P.MouseUp:u=u.replace("mouse","pointer");break;case P.TouchStart:case P.TouchEnd:return}i.push(A(u,p,t))}),M(()=>{i.forEach(d=>d())})}function wt({scrollCb:e,doc:t,mirror:r,blockClass:n,blockSelector:o,sampling:a}){const l=M(he(M(i=>{const s=fe(i);if(!s||F(s,n,o,!0))return;const c=r.getId(s);if(s===t&&t.defaultView){const d=rt(t.defaultView);e({id:c,x:d.left,y:d.top})}else e({id:c,x:s.scrollLeft,y:s.scrollTop})}),a.scroll||100));return A("scroll",l,t)}function Fr({viewportResizeCb:e},{win:t}){let r=-1,n=-1;const o=M(he(M(()=>{const a=nt(),l=ot();(r!==a||n!==l)&&(e({width:Number(l),height:Number(a)}),r=a,n=l)}),200));return A("resize",o,t)}const _r=["INPUT","TEXTAREA","SELECT"],It=new WeakMap;function Pr({inputCb:e,doc:t,mirror:r,blockClass:n,blockSelector:o,ignoreClass:a,ignoreSelector:l,maskInputOptions:i,maskInputFn:s,sampling:c,userTriggeredOnInput:d}){function u(S){let b=fe(S);const g=S.isTrusted,v=b&&b.tagName;if(b&&v==="OPTION"&&(b=b.parentElement),!b||!v||_r.indexOf(v)<0||F(b,n,o,!0)||b.classList.contains(a)||l&&b.matches(l))return;let x=b.value,D=!1;const V=Fe(b)||"";V==="radio"||V==="checkbox"?D=b.checked:(i[v.toLowerCase()]||i[V])&&(x=Ae({element:b,maskInputOptions:i,tagName:v,type:V,value:x,maskInputFn:s})),p(b,d?{text:x,isChecked:D,userTriggered:g}:{text:x,isChecked:D});const U=b.name;V==="radio"&&U&&D&&t.querySelectorAll(`input[type="radio"][name="${U}"]`).forEach(z=>{if(z!==b){const H=z.value;p(z,d?{text:H,isChecked:!D,userTriggered:!1}:{text:H,isChecked:!D})}})}function p(S,b){const g=It.get(S);if(!g||g.text!==b.text||g.isChecked!==b.isChecked){It.set(S,b);const v=r.getId(S);M(e)(Nr(bt({},b),{id:v}))}}const m=(c.input==="last"?["change"]:["input","change"]).map(S=>A(S,M(u),t)),f=t.defaultView;if(!f)return()=>{m.forEach(S=>S())};const h=f.Object.getOwnPropertyDescriptor(f.HTMLInputElement.prototype,"value"),y=[[f.HTMLInputElement.prototype,"value"],[f.HTMLInputElement.prototype,"checked"],[f.HTMLSelectElement.prototype,"value"],[f.HTMLTextAreaElement.prototype,"value"],[f.HTMLSelectElement.prototype,"selectedIndex"],[f.HTMLOptionElement.prototype,"selected"]];return h&&h.set&&m.push(...y.map(S=>we(S[0],S[1],{set(){M(u)({target:this,isTrusted:!1})}},!1,f))),M(()=>{m.forEach(S=>S())})}function Me(e){const t=[];function r(n,o){if(Ce("CSSGroupingRule")&&n.parentRule instanceof CSSGroupingRule||Ce("CSSMediaRule")&&n.parentRule instanceof CSSMediaRule||Ce("CSSSupportsRule")&&n.parentRule instanceof CSSSupportsRule||Ce("CSSConditionRule")&&n.parentRule instanceof CSSConditionRule){const a=Array.from(n.parentRule.cssRules).indexOf(n);o.unshift(a)}else if(n.parentStyleSheet){const a=Array.from(n.parentStyleSheet.cssRules).indexOf(n);o.unshift(a)}return o}return r(e,t)}function Y(e,t,r){let n,o;return e?(e.ownerNode?n=t.getId(e.ownerNode):o=r.getId(e),{styleId:o,id:n}):{}}function Wr({styleSheetRuleCb:e,mirror:t,stylesheetManager:r},{win:n}){if(!n.CSSStyleSheet||!n.CSSStyleSheet.prototype)return()=>{};const o=n.CSSStyleSheet.prototype.insertRule;n.CSSStyleSheet.prototype.insertRule=new Proxy(o,{apply:M((d,u,p)=>{const[m,f]=p,{id:h,styleId:y}=Y(u,t,r.styleMirror);return(h&&h!==-1||y&&y!==-1)&&e({id:h,styleId:y,adds:[{rule:m,index:f}]}),d.apply(u,p)})});const a=n.CSSStyleSheet.prototype.deleteRule;n.CSSStyleSheet.prototype.deleteRule=new Proxy(a,{apply:M((d,u,p)=>{const[m]=p,{id:f,styleId:h}=Y(u,t,r.styleMirror);return(f&&f!==-1||h&&h!==-1)&&e({id:f,styleId:h,removes:[{index:m}]}),d.apply(u,p)})});let l;n.CSSStyleSheet.prototype.replace&&(l=n.CSSStyleSheet.prototype.replace,n.CSSStyleSheet.prototype.replace=new Proxy(l,{apply:M((d,u,p)=>{const[m]=p,{id:f,styleId:h}=Y(u,t,r.styleMirror);return(f&&f!==-1||h&&h!==-1)&&e({id:f,styleId:h,replace:m}),d.apply(u,p)})}));let i;n.CSSStyleSheet.prototype.replaceSync&&(i=n.CSSStyleSheet.prototype.replaceSync,n.CSSStyleSheet.prototype.replaceSync=new Proxy(i,{apply:M((d,u,p)=>{const[m]=p,{id:f,styleId:h}=Y(u,t,r.styleMirror);return(f&&f!==-1||h&&h!==-1)&&e({id:f,styleId:h,replaceSync:m}),d.apply(u,p)})}));const s={};ke("CSSGroupingRule")?s.CSSGroupingRule=n.CSSGroupingRule:(ke("CSSMediaRule")&&(s.CSSMediaRule=n.CSSMediaRule),ke("CSSConditionRule")&&(s.CSSConditionRule=n.CSSConditionRule),ke("CSSSupportsRule")&&(s.CSSSupportsRule=n.CSSSupportsRule));const c={};return Object.entries(s).forEach(([d,u])=>{c[d]={insertRule:u.prototype.insertRule,deleteRule:u.prototype.deleteRule},u.prototype.insertRule=new Proxy(c[d].insertRule,{apply:M((p,m,f)=>{const[h,y]=f,{id:S,styleId:b}=Y(m.parentStyleSheet,t,r.styleMirror);return(S&&S!==-1||b&&b!==-1)&&e({id:S,styleId:b,adds:[{rule:h,index:[...Me(m),y||0]}]}),p.apply(m,f)})}),u.prototype.deleteRule=new Proxy(c[d].deleteRule,{apply:M((p,m,f)=>{const[h]=f,{id:y,styleId:S}=Y(m.parentStyleSheet,t,r.styleMirror);return(y&&y!==-1||S&&S!==-1)&&e({id:y,styleId:S,removes:[{index:[...Me(m),h]}]}),p.apply(m,f)})})}),M(()=>{n.CSSStyleSheet.prototype.insertRule=o,n.CSSStyleSheet.prototype.deleteRule=a,l&&(n.CSSStyleSheet.prototype.replace=l),i&&(n.CSSStyleSheet.prototype.replaceSync=i),Object.entries(s).forEach(([d,u])=>{u.prototype.insertRule=c[d].insertRule,u.prototype.deleteRule=c[d].deleteRule})})}function Mt({mirror:e,stylesheetManager:t},r){var n,o,a;let l=null;r.nodeName==="#document"?l=e.getId(r):l=e.getId(r.host);const i=r.nodeName==="#document"?(n=r.defaultView)==null?void 0:n.Document:(a=(o=r.ownerDocument)==null?void 0:o.defaultView)==null?void 0:a.ShadowRoot,s=i!=null&&i.prototype?Object.getOwnPropertyDescriptor(i?.prototype,"adoptedStyleSheets"):void 0;return l===null||l===-1||!i||!s?()=>{}:(Object.defineProperty(r,"adoptedStyleSheets",{configurable:s.configurable,enumerable:s.enumerable,get(){var c;return(c=s.get)==null?void 0:c.call(this)},set(c){var d;const u=(d=s.set)==null?void 0:d.call(this,c);if(l!==null&&l!==-1)try{t.adoptStyleSheets(c,l)}catch{}return u}}),M(()=>{Object.defineProperty(r,"adoptedStyleSheets",{configurable:s.configurable,enumerable:s.enumerable,get:s.get,set:s.set})}))}function $r({styleDeclarationCb:e,mirror:t,ignoreCSSAttributes:r,stylesheetManager:n},{win:o}){const a=o.CSSStyleDeclaration.prototype.setProperty;o.CSSStyleDeclaration.prototype.setProperty=new Proxy(a,{apply:M((i,s,c)=>{var d;const[u,p,m]=c;if(r.has(u))return a.apply(s,[u,p,m]);const{id:f,styleId:h}=Y((d=s.parentRule)==null?void 0:d.parentStyleSheet,t,n.styleMirror);return(f&&f!==-1||h&&h!==-1)&&e({id:f,styleId:h,set:{property:u,value:p,priority:m},index:Me(s.parentRule)}),i.apply(s,c)})});const l=o.CSSStyleDeclaration.prototype.removeProperty;return o.CSSStyleDeclaration.prototype.removeProperty=new Proxy(l,{apply:M((i,s,c)=>{var d;const[u]=c;if(r.has(u))return l.apply(s,[u]);const{id:p,styleId:m}=Y((d=s.parentRule)==null?void 0:d.parentStyleSheet,t,n.styleMirror);return(p&&p!==-1||m&&m!==-1)&&e({id:p,styleId:m,remove:{property:u},index:Me(s.parentRule)}),i.apply(s,c)})}),M(()=>{o.CSSStyleDeclaration.prototype.setProperty=a,o.CSSStyleDeclaration.prototype.removeProperty=l})}function Ur({mediaInteractionCb:e,blockClass:t,blockSelector:r,mirror:n,sampling:o,doc:a}){const l=M(s=>he(M(c=>{const d=fe(c);if(!d||F(d,t,r,!0))return;const{currentTime:u,volume:p,muted:m,playbackRate:f}=d;e({type:s,id:n.getId(d),currentTime:u,volume:p,muted:m,playbackRate:f})}),o.media||500)),i=[A("play",l(ie.Play),a),A("pause",l(ie.Pause),a),A("seeked",l(ie.Seeked),a),A("volumechange",l(ie.VolumeChange),a),A("ratechange",l(ie.RateChange),a)];return M(()=>{i.forEach(s=>s())})}function jr({fontCb:e,doc:t}){const r=t.defaultView;if(!r)return()=>{};const n=[],o=new WeakMap,a=r.FontFace;r.FontFace=function(i,s,c){const d=new a(i,s,c);return o.set(d,{family:i,buffer:typeof s!="string",descriptors:c,fontSource:typeof s=="string"?s:JSON.stringify(Array.from(new Uint8Array(s)))}),d};const l=se(t.fonts,"add",function(i){return function(s){return setTimeout(M(()=>{const c=o.get(s);c&&(e(c),o.delete(s))}),0),i.apply(this,[s])}});return n.push(()=>{r.FontFace=a}),n.push(l),M(()=>{n.forEach(i=>i())})}function zr(e){const{doc:t,mirror:r,blockClass:n,blockSelector:o,selectionCb:a}=e;let l=!0;const i=M(()=>{const s=t.getSelection();if(!s||l&&s?.isCollapsed)return;l=s.isCollapsed||!1;const c=[],d=s.rangeCount||0;for(let u=0;u<d;u++){const p=s.getRangeAt(u),{startContainer:m,startOffset:f,endContainer:h,endOffset:y}=p;F(m,n,o,!0)||F(h,n,o,!0)||c.push({start:r.getId(m),startOffset:f,end:r.getId(h),endOffset:y})}a({ranges:c})});return i(),A("selectionchange",i)}function Hr({doc:e,customElementCb:t}){const r=e.defaultView;return!r||!r.customElements?()=>{}:se(r.customElements,"define",function(n){return function(o,a,l){try{t({define:{name:o}})}catch{console.warn(`Custom element callback failed for ${o}`)}return n.apply(this,[o,a,l])}})}function Br(e,t){const{mutationCb:r,mousemoveCb:n,mouseInteractionCb:o,scrollCb:a,viewportResizeCb:l,inputCb:i,mediaInteractionCb:s,styleSheetRuleCb:c,styleDeclarationCb:d,canvasMutationCb:u,fontCb:p,selectionCb:m,customElementCb:f}=e;e.mutationCb=(...h)=>{t.mutation&&t.mutation(...h),r(...h)},e.mousemoveCb=(...h)=>{t.mousemove&&t.mousemove(...h),n(...h)},e.mouseInteractionCb=(...h)=>{t.mouseInteraction&&t.mouseInteraction(...h),o(...h)},e.scrollCb=(...h)=>{t.scroll&&t.scroll(...h),a(...h)},e.viewportResizeCb=(...h)=>{t.viewportResize&&t.viewportResize(...h),l(...h)},e.inputCb=(...h)=>{t.input&&t.input(...h),i(...h)},e.mediaInteractionCb=(...h)=>{t.mediaInteaction&&t.mediaInteaction(...h),s(...h)},e.styleSheetRuleCb=(...h)=>{t.styleSheetRule&&t.styleSheetRule(...h),c(...h)},e.styleDeclarationCb=(...h)=>{t.styleDeclaration&&t.styleDeclaration(...h),d(...h)},e.canvasMutationCb=(...h)=>{t.canvasMutation&&t.canvasMutation(...h),u(...h)},e.fontCb=(...h)=>{t.font&&t.font(...h),p(...h)},e.selectionCb=(...h)=>{t.selection&&t.selection(...h),m(...h)},e.customElementCb=(...h)=>{t.customElement&&t.customElement(...h),f(...h)}}function Vr(e,t={}){const r=e.doc.defaultView;if(!r)return()=>{};Br(e,t);let n;e.recordDOM&&(n=vt(e,e.doc));const o=Dr(e),a=Ar(e),l=wt(e),i=Fr(e,{win:r}),s=Pr(e),c=Ur(e);let d=()=>{},u=()=>{},p=()=>{},m=()=>{};e.recordDOM&&(d=Wr(e,{win:r}),u=Mt(e,e.doc),p=$r(e,{win:r}),e.collectFonts&&(m=jr(e)));const f=zr(e),h=Hr(e),y=[];for(const S of e.plugins)y.push(S.observer(S.callback,r,S.options));return M(()=>{Q.forEach(S=>S.reset()),n?.disconnect(),o(),a(),l(),i(),s(),c(),d(),u(),p(),m(),f(),h(),y.forEach(S=>S())})}function Ce(e){return typeof window[e]<"u"}function ke(e){return Boolean(typeof window[e]<"u"&&window[e].prototype&&"insertRule"in window[e].prototype&&"deleteRule"in window[e].prototype)}class Ct{constructor(t){this.generateIdFn=t,this.iframeIdToRemoteIdMap=new WeakMap,this.iframeRemoteIdToIdMap=new WeakMap}getId(t,r,n,o){const a=n||this.getIdToRemoteIdMap(t),l=o||this.getRemoteIdToIdMap(t);let i=a.get(r);return i||(i=this.generateIdFn(),a.set(r,i),l.set(i,r)),i}getIds(t,r){const n=this.getIdToRemoteIdMap(t),o=this.getRemoteIdToIdMap(t);return r.map(a=>this.getId(t,a,n,o))}getRemoteId(t,r,n){const o=n||this.getRemoteIdToIdMap(t);return typeof r!="number"?r:o.get(r)||-1}getRemoteIds(t,r){const n=this.getRemoteIdToIdMap(t);return r.map(o=>this.getRemoteId(t,o,n))}reset(t){if(!t){this.iframeIdToRemoteIdMap=new WeakMap,this.iframeRemoteIdToIdMap=new WeakMap;return}this.iframeIdToRemoteIdMap.delete(t),this.iframeRemoteIdToIdMap.delete(t)}getIdToRemoteIdMap(t){let r=this.iframeIdToRemoteIdMap.get(t);return r||(r=new Map,this.iframeIdToRemoteIdMap.set(t,r)),r}getRemoteIdToIdMap(t){let r=this.iframeRemoteIdToIdMap.get(t);return r||(r=new Map,this.iframeRemoteIdToIdMap.set(t,r)),r}}class Gr{constructor(t){this.iframes=new WeakMap,this.crossOriginIframeMap=new WeakMap,this.crossOriginIframeMirror=new Ct(Je),this.crossOriginIframeRootIdMap=new WeakMap,this.mutationCb=t.mutationCb,this.wrappedEmit=t.wrappedEmit,this.stylesheetManager=t.stylesheetManager,this.recordCrossOriginIframes=t.recordCrossOriginIframes,this.crossOriginIframeStyleMirror=new Ct(this.stylesheetManager.styleMirror.generateId.bind(this.stylesheetManager.styleMirror)),this.mirror=t.mirror,this.recordCrossOriginIframes&&window.addEventListener("message",this.handleMessage.bind(this))}addIframe(t){this.iframes.set(t,!0),t.contentWindow&&this.crossOriginIframeMap.set(t.contentWindow,t)}addLoadListener(t){this.loadListener=t}attachIframe(t,r){var n;this.mutationCb({adds:[{parentId:this.mirror.getId(t),nextId:null,node:r}],removes:[],texts:[],attributes:[],isAttachIframe:!0}),(n=this.loadListener)==null||n.call(this,t),t.contentDocument&&t.contentDocument.adoptedStyleSheets&&t.contentDocument.adoptedStyleSheets.length>0&&this.stylesheetManager.adoptStyleSheets(t.contentDocument.adoptedStyleSheets,this.mirror.getId(t.contentDocument))}handleMessage(t){const r=t;if(r.data.type!=="rrweb"||r.origin!==r.data.origin||!t.source)return;const n=this.crossOriginIframeMap.get(t.source);if(!n)return;const o=this.transformCrossOriginEvent(n,r.data.event);o&&this.wrappedEmit(o,r.data.isCheckout)}transformCrossOriginEvent(t,r){var n;switch(r.type){case C.FullSnapshot:{this.crossOriginIframeMirror.reset(t),this.crossOriginIframeStyleMirror.reset(t),this.replaceIdOnNode(r.data.node,t);const o=r.data.node.id;return this.crossOriginIframeRootIdMap.set(t,o),this.patchRootIdOnNode(r.data.node,o),{timestamp:r.timestamp,type:C.IncrementalSnapshot,data:{source:I.Mutation,adds:[{parentId:this.mirror.getId(t),nextId:null,node:r.data.node}],removes:[],texts:[],attributes:[],isAttachIframe:!0}}}case C.Meta:case C.Load:case C.DomContentLoaded:return!1;case C.Plugin:return r;case C.Custom:return this.replaceIds(r.data.payload,t,["id","parentId","previousId","nextId"]),r;case C.IncrementalSnapshot:switch(r.data.source){case I.Mutation:return r.data.adds.forEach(o=>{this.replaceIds(o,t,["parentId","nextId","previousId"]),this.replaceIdOnNode(o.node,t);const a=this.crossOriginIframeRootIdMap.get(t);a&&this.patchRootIdOnNode(o.node,a)}),r.data.removes.forEach(o=>{this.replaceIds(o,t,["parentId","id"])}),r.data.attributes.forEach(o=>{this.replaceIds(o,t,["id"])}),r.data.texts.forEach(o=>{this.replaceIds(o,t,["id"])}),r;case I.Drag:case I.TouchMove:case I.MouseMove:return r.data.positions.forEach(o=>{this.replaceIds(o,t,["id"])}),r;case I.ViewportResize:return!1;case I.MediaInteraction:case I.MouseInteraction:case I.Scroll:case I.CanvasMutation:case I.Input:return this.replaceIds(r.data,t,["id"]),r;case I.StyleSheetRule:case I.StyleDeclaration:return this.replaceIds(r.data,t,["id"]),this.replaceStyleIds(r.data,t,["styleId"]),r;case I.Font:return r;case I.Selection:return r.data.ranges.forEach(o=>{this.replaceIds(o,t,["start","end"])}),r;case I.AdoptedStyleSheet:return this.replaceIds(r.data,t,["id"]),this.replaceStyleIds(r.data,t,["styleIds"]),(n=r.data.styles)==null||n.forEach(o=>{this.replaceStyleIds(o,t,["styleId"])}),r}}return!1}replace(t,r,n,o){for(const a of o)!Array.isArray(r[a])&&typeof r[a]!="number"||(Array.isArray(r[a])?r[a]=t.getIds(n,r[a]):r[a]=t.getId(n,r[a]));return r}replaceIds(t,r,n){return this.replace(this.crossOriginIframeMirror,t,r,n)}replaceStyleIds(t,r,n){return this.replace(this.crossOriginIframeStyleMirror,t,r,n)}replaceIdOnNode(t,r){this.replaceIds(t,r,["id","rootId"]),"childNodes"in t&&t.childNodes.forEach(n=>{this.replaceIdOnNode(n,r)})}patchRootIdOnNode(t,r){t.type!==L.Document&&!t.rootId&&(t.rootId=r),"childNodes"in t&&t.childNodes.forEach(n=>{this.patchRootIdOnNode(n,r)})}}var qr=Object.defineProperty,Xr=Object.defineProperties,Yr=Object.getOwnPropertyDescriptors,kt=Object.getOwnPropertySymbols,Jr=Object.prototype.hasOwnProperty,Kr=Object.prototype.propertyIsEnumerable,Ot=(e,t,r)=>t in e?qr(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,Tt=(e,t)=>{for(var r in t||(t={}))Jr.call(t,r)&&Ot(e,r,t[r]);if(kt)for(var r of kt(t))Kr.call(t,r)&&Ot(e,r,t[r]);return e},Et=(e,t)=>Xr(e,Yr(t));class Qr{constructor(t){this.shadowDoms=new WeakSet,this.restoreHandlers=[],this.mutationCb=t.mutationCb,this.scrollCb=t.scrollCb,this.bypassOptions=t.bypassOptions,this.mirror=t.mirror,this.init()}init(){this.reset(),this.patchAttachShadow(Element,document)}addShadowRoot(t,r){if(!ue(t)||this.shadowDoms.has(t))return;this.shadowDoms.add(t),this.bypassOptions.canvasManager.addShadowRoot(t);const n=vt(Et(Tt({},this.bypassOptions),{doc:r,mutationCb:this.mutationCb,mirror:this.mirror,shadowDomManager:this}),t);this.restoreHandlers.push(()=>n.disconnect()),this.restoreHandlers.push(wt(Et(Tt({},this.bypassOptions),{scrollCb:this.scrollCb,doc:t,mirror:this.mirror}))),setTimeout(()=>{t.adoptedStyleSheets&&t.adoptedStyleSheets.length>0&&this.bypassOptions.stylesheetManager.adoptStyleSheets(t.adoptedStyleSheets,this.mirror.getId(t.host)),this.restoreHandlers.push(Mt({mirror:this.mirror,stylesheetManager:this.bypassOptions.stylesheetManager},t))},0)}observeAttachShadow(t){!t.contentWindow||!t.contentDocument||this.patchAttachShadow(t.contentWindow.Element,t.contentDocument)}patchAttachShadow(t,r){const n=this;this.restoreHandlers.push(se(t.prototype,"attachShadow",function(o){return function(a){const l=o.call(this,a);return this.shadowRoot&&dt(this)&&n.addShadowRoot(this.shadowRoot,r),l}}))}reset(){this.restoreHandlers.forEach(t=>{try{t()}catch{}}),this.restoreHandlers=[],this.shadowDoms=new WeakSet,this.bypassOptions.canvasManager.resetShadowRoots()}}for(var le="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Zr=typeof Uint8Array>"u"?[]:new Uint8Array(256),Oe=0;Oe<le.length;Oe++)Zr[le.charCodeAt(Oe)]=Oe;var en=function(e){var t=new Uint8Array(e),r,n=t.length,o="";for(r=0;r<n;r+=3)o+=le[t[r]>>2],o+=le[(t[r]&3)<<4|t[r+1]>>4],o+=le[(t[r+1]&15)<<2|t[r+2]>>6],o+=le[t[r+2]&63];return n%3===2?o=o.substring(0,o.length-1)+"=":n%3===1&&(o=o.substring(0,o.length-2)+"=="),o};const Rt=new Map;function tn(e,t){let r=Rt.get(e);return r||(r=new Map,Rt.set(e,r)),r.has(t)||r.set(t,[]),r.get(t)}const xt=(e,t,r)=>{if(!e||!(Nt(e,t)||typeof e=="object"))return;const n=e.constructor.name,o=tn(r,n);let a=o.indexOf(e);return a===-1&&(a=o.length,o.push(e)),a};function Te(e,t,r){if(e instanceof Array)return e.map(n=>Te(n,t,r));if(e===null)return e;if(e instanceof Float32Array||e instanceof Float64Array||e instanceof Int32Array||e instanceof Uint32Array||e instanceof Uint8Array||e instanceof Uint16Array||e instanceof Int16Array||e instanceof Int8Array||e instanceof Uint8ClampedArray)return{rr_type:e.constructor.name,args:[Object.values(e)]};if(e instanceof ArrayBuffer){const n=e.constructor.name,o=en(e);return{rr_type:n,base64:o}}else{if(e instanceof DataView)return{rr_type:e.constructor.name,args:[Te(e.buffer,t,r),e.byteOffset,e.byteLength]};if(e instanceof HTMLImageElement){const n=e.constructor.name,{src:o}=e;return{rr_type:n,src:o}}else if(e instanceof HTMLCanvasElement){const n="HTMLImageElement",o=e.toDataURL();return{rr_type:n,src:o}}else{if(e instanceof ImageData)return{rr_type:e.constructor.name,args:[Te(e.data,t,r),e.width,e.height]};if(Nt(e,t)||typeof e=="object"){const n=e.constructor.name,o=xt(e,t,r);return{rr_type:n,index:o}}}}return e}const Lt=(e,t,r)=>e.map(n=>Te(n,t,r)),Nt=(e,t)=>{const r=["WebGLActiveInfo","WebGLBuffer","WebGLFramebuffer","WebGLProgram","WebGLRenderbuffer","WebGLShader","WebGLShaderPrecisionFormat","WebGLTexture","WebGLUniformLocation","WebGLVertexArrayObject","WebGLVertexArrayObjectOES"].filter(n=>typeof t[n]=="function");return Boolean(r.find(n=>e instanceof t[n]))};function rn(e,t,r,n){const o=[],a=Object.getOwnPropertyNames(t.CanvasRenderingContext2D.prototype);for(const l of a)try{if(typeof t.CanvasRenderingContext2D.prototype[l]!="function")continue;const i=se(t.CanvasRenderingContext2D.prototype,l,function(s){return function(...c){return F(this.canvas,r,n,!0)||setTimeout(()=>{const d=Lt(c,t,this);e(this.canvas,{type:ae["2D"],property:l,args:d})},0),s.apply(this,c)}});o.push(i)}catch{const s=we(t.CanvasRenderingContext2D.prototype,l,{set(c){e(this.canvas,{type:ae["2D"],property:l,args:[c],setter:!0})}});o.push(s)}return()=>{o.forEach(l=>l())}}function nn(e){return e==="experimental-webgl"?"webgl":e}function Dt(e,t,r,n){const o=[];try{const a=se(e.HTMLCanvasElement.prototype,"getContext",function(l){return function(i,...s){if(!F(this,t,r,!0)){const c=nn(i);if("__context"in this||(this.__context=c),n&&["webgl","webgl2"].includes(c))if(s[0]&&typeof s[0]=="object"){const d=s[0];d.preserveDrawingBuffer||(d.preserveDrawingBuffer=!0)}else s.splice(0,1,{preserveDrawingBuffer:!0})}return l.apply(this,[i,...s])}});o.push(a)}catch{console.error("failed to patch HTMLCanvasElement.prototype.getContext")}return()=>{o.forEach(a=>a())}}function At(e,t,r,n,o,a,l){const i=[],s=Object.getOwnPropertyNames(e);for(const c of s)if(!["isContextLost","canvas","drawingBufferWidth","drawingBufferHeight"].includes(c))try{if(typeof e[c]!="function")continue;const d=se(e,c,function(u){return function(...p){const m=u.apply(this,p);if(xt(m,l,this),"tagName"in this.canvas&&!F(this.canvas,n,o,!0)){const f=Lt(p,l,this),h={type:t,property:c,args:f};r(this.canvas,h)}return m}});i.push(d)}catch{const u=we(e,c,{set(p){r(this.canvas,{type:t,property:c,args:[p],setter:!0})}});i.push(u)}return i}function on(e,t,r,n,o){const a=[];return a.push(...At(t.WebGLRenderingContext.prototype,ae.WebGL,e,r,n,o,t)),typeof t.WebGL2RenderingContext<"u"&&a.push(...At(t.WebGL2RenderingContext.prototype,ae.WebGL2,e,r,n,o,t)),()=>{a.forEach(l=>l())}}function sn(e,t){var r=t===void 0?null:t,n=e.toString(),o=n.split(`
`);o.pop(),o.shift();for(var a=o[0].search(/\S/),l=/(['"])__worker_loader_strict__(['"])/g,i=0,s=o.length;i<s;++i)o[i]=o[i].substring(a).replace(l,"$1use strict$2")+`
`;return r&&o.push("//# sourceMappingURL="+r+`
`),o}function an(e,t){var r=sn(e,t),n=new Blob(r,{type:"application/javascript"});return URL.createObjectURL(n)}function ln(e,t){var r;return function(o){return r=r||an(e,t),new Worker(r,o)}}var cn=ln(function(){(function(){for(var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",t=typeof Uint8Array>"u"?[]:new Uint8Array(256),r=0;r<e.length;r++)t[e.charCodeAt(r)]=r;var n=function(s){var c=new Uint8Array(s),d,u=c.length,p="";for(d=0;d<u;d+=3)p+=e[c[d]>>2],p+=e[(c[d]&3)<<4|c[d+1]>>4],p+=e[(c[d+1]&15)<<2|c[d+2]>>6],p+=e[c[d+2]&63];return u%3===2?p=p.substring(0,p.length-1)+"=":u%3===1&&(p=p.substring(0,p.length-2)+"=="),p};const o=new Map,a=new Map;async function l(s,c,d){const u=`${s}-${c}`;if("OffscreenCanvas"in globalThis){if(a.has(u))return a.get(u);const p=new OffscreenCanvas(s,c);p.getContext("2d");const m=await(await p.convertToBlob(d)).arrayBuffer(),f=n(m);return a.set(u,f),f}else return""}const i=self;i.onmessage=async function(s){if("OffscreenCanvas"in globalThis){const{id:c,bitmap:d,width:u,height:p,dataURLOptions:m}=s.data,f=l(u,p,m),h=new OffscreenCanvas(u,p);h.getContext("2d").drawImage(d,0,0),d.close();const y=await h.convertToBlob(m),S=y.type,b=await y.arrayBuffer(),g=n(b);if(!o.has(c)&&await f===g)return o.set(c,g),i.postMessage({id:c});if(o.get(c)===g)return i.postMessage({id:c});i.postMessage({id:c,type:S,base64:g,width:u,height:p}),o.set(c,g)}else return i.postMessage({id:s.data.id})}})()},null),Ft=Object.getOwnPropertySymbols,dn=Object.prototype.hasOwnProperty,un=Object.prototype.propertyIsEnumerable,pn=(e,t)=>{var r={};for(var n in e)dn.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&Ft)for(var n of Ft(e))t.indexOf(n)<0&&un.call(e,n)&&(r[n]=e[n]);return r},hn=(e,t,r)=>new Promise((n,o)=>{var a=s=>{try{i(r.next(s))}catch(c){o(c)}},l=s=>{try{i(r.throw(s))}catch(c){o(c)}},i=s=>s.done?n(s.value):Promise.resolve(s.value).then(a,l);i((r=r.apply(e,t)).next())});class mn{constructor(t){this.pendingCanvasMutations=new Map,this.rafStamps={latestId:0,invokeId:null},this.shadowDoms=new Set,this.windowsSet=new WeakSet,this.windows=[],this.restoreHandlers=[],this.frozen=!1,this.locked=!1,this.snapshotInProgressMap=new Map,this.worker=null,this.processMutation=(s,c)=>{(this.rafStamps.invokeId&&this.rafStamps.latestId!==this.rafStamps.invokeId||!this.rafStamps.invokeId)&&(this.rafStamps.invokeId=this.rafStamps.latestId),this.pendingCanvasMutations.has(s)||this.pendingCanvasMutations.set(s,[]),this.pendingCanvasMutations.get(s).push(c)};const{sampling:r="all",win:n,blockClass:o,blockSelector:a,recordCanvas:l,dataURLOptions:i}=t;this.mutationCb=t.mutationCb,this.mirror=t.mirror,this.options=t,l&&r==="all"&&(this.startRAFTimestamping(),this.startPendingCanvasMutationFlusher()),l&&typeof r=="number"&&(this.worker=this.initFPSWorker(),this.initCanvasFPSObserver(r,o,a,{dataURLOptions:i})),this.addWindow(n)}reset(){this.pendingCanvasMutations.clear(),this.restoreHandlers.forEach(t=>{try{t()}catch{}}),this.restoreHandlers=[],this.windowsSet=new WeakSet,this.windows=[],this.shadowDoms=new Set,this.worker=null,this.snapshotInProgressMap=new Map,this.options.recordCanvas&&typeof this.options.sampling=="number"&&(this.worker=this.initFPSWorker())}freeze(){this.frozen=!0}unfreeze(){this.frozen=!1}lock(){this.locked=!0}unlock(){this.locked=!1}addWindow(t){const{sampling:r="all",blockClass:n,blockSelector:o,recordCanvas:a}=this.options;if(!this.windowsSet.has(t)){if(a&&r==="all"&&this.initCanvasMutationObserver(t,n,o),a&&typeof r=="number"){const l=Dt(t,n,o,!0);this.restoreHandlers.push(()=>{l()})}this.windowsSet.add(t),this.windows.push(new WeakRef(t))}}addShadowRoot(t){this.shadowDoms.add(new WeakRef(t))}resetShadowRoots(){this.shadowDoms=new Set}initFPSWorker(){const t=new cn;return t.onmessage=r=>{const{id:n}=r.data;if(this.snapshotInProgressMap.set(n,!1),!("base64"in r.data))return;const{base64:o,type:a,width:l,height:i}=r.data;this.mutationCb({id:n,type:ae["2D"],commands:[{property:"clearRect",args:[0,0,l,i]},{property:"drawImage",args:[{rr_type:"ImageBitmap",args:[{rr_type:"Blob",data:[{rr_type:"ArrayBuffer",base64:o}],type:a}]},0,0]}]})},t}initCanvasFPSObserver(t,r,n,o){const a=1e3/t;let l=0,i;const s=()=>{const d=[],u=p=>{p.querySelectorAll("canvas").forEach(m=>{F(m,r,n,!0)||d.push(m)})};for(const p of this.windows){const m=p.deref();m&&u(m.document)}for(const p of this.shadowDoms){const m=p.deref();m&&u(m)}return d},c=d=>{if(this.windows.length){if(l&&d-l<a){i=requestAnimationFrame(c);return}l=d,s().forEach(u=>hn(this,null,function*(){var p,m;if(!this.mirror.hasNode(u))return;const f=this.mirror.getId(u);if(this.snapshotInProgressMap.get(f)||u.width===0||u.height===0)return;if(this.snapshotInProgressMap.set(f,!0),["webgl","webgl2"].includes(u.__context)){const y=u.getContext(u.__context);((p=y?.getContextAttributes())==null?void 0:p.preserveDrawingBuffer)===!1&&y.clear(y.COLOR_BUFFER_BIT)}const h=yield createImageBitmap(u);(m=this.worker)==null||m.postMessage({id:f,bitmap:h,width:u.width,height:u.height,dataURLOptions:o.dataURLOptions},[h])})),i=requestAnimationFrame(c)}};i=requestAnimationFrame(c),this.restoreHandlers.push(()=>{cancelAnimationFrame(i)})}initCanvasMutationObserver(t,r,n){const o=Dt(t,r,n,!1),a=rn(this.processMutation.bind(this),t,r,n),l=on(this.processMutation.bind(this),t,r,n,this.mirror);this.restoreHandlers.push(()=>{o(),a(),l()})}startPendingCanvasMutationFlusher(){requestAnimationFrame(()=>this.flushPendingCanvasMutations())}startRAFTimestamping(){const t=r=>{this.rafStamps.latestId=r,requestAnimationFrame(t)};requestAnimationFrame(t)}flushPendingCanvasMutations(){this.pendingCanvasMutations.forEach((t,r)=>{const n=this.mirror.getId(r);this.flushPendingCanvasMutationFor(r,n)}),requestAnimationFrame(()=>this.flushPendingCanvasMutations())}flushPendingCanvasMutationFor(t,r){if(this.frozen||this.locked)return;const n=this.pendingCanvasMutations.get(t);if(!n||r===-1)return;const o=n.map(l=>pn(l,["type"])),{type:a}=n[0];this.mutationCb({id:r,type:a,commands:o}),this.pendingCanvasMutations.delete(t)}}class fn{constructor(t){this.trackedLinkElements=new WeakSet,this.styleMirror=new br,this.mutationCb=t.mutationCb,this.adoptedStyleSheetCb=t.adoptedStyleSheetCb}attachLinkElement(t,r){"_cssText"in r.attributes&&this.mutationCb({adds:[],removes:[],texts:[],attributes:[{id:r.id,attributes:r.attributes}]}),this.trackLinkElement(t)}trackLinkElement(t){this.trackedLinkElements.has(t)||(this.trackedLinkElements.add(t),this.trackStylesheetInLinkElement(t))}adoptStyleSheets(t,r){if(t.length===0)return;const n={id:r,styleIds:[]},o=[];for(const a of t){let l;this.styleMirror.has(a)?l=this.styleMirror.getId(a):(l=this.styleMirror.add(a),o.push({styleId:l,rules:Array.from(a.rules||CSSRule,(i,s)=>({rule:Ge(i),index:s}))})),n.styleIds.push(l)}o.length>0&&(n.styles=o),this.adoptedStyleSheetCb(n)}reset(){this.styleMirror.reset(),this.trackedLinkElements=new WeakSet}trackStylesheetInLinkElement(t){}}class yn{constructor(){this.nodeMap=new WeakMap,this.loop=!0,this.periodicallyClear()}periodicallyClear(){requestAnimationFrame(()=>{this.clear(),this.loop&&this.periodicallyClear()})}inOtherBuffer(t,r){const n=this.nodeMap.get(t);return n&&Array.from(n).some(o=>o!==r)}add(t,r){this.nodeMap.set(t,(this.nodeMap.get(t)||new Set).add(r))}clear(){this.nodeMap=new WeakMap}destroy(){this.loop=!1}}var gn=Object.defineProperty,Sn=Object.defineProperties,bn=Object.getOwnPropertyDescriptors,_t=Object.getOwnPropertySymbols,vn=Object.prototype.hasOwnProperty,wn=Object.prototype.propertyIsEnumerable,Pt=(e,t,r)=>t in e?gn(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,W=(e,t)=>{for(var r in t||(t={}))vn.call(t,r)&&Pt(e,r,t[r]);if(_t)for(var r of _t(t))wn.call(t,r)&&Pt(e,r,t[r]);return e},In=(e,t)=>Sn(e,bn(t));function N(e){return In(W({},e),{timestamp:Ie()})}let R,Ee,Re,xe=!1;const j=Xt();function ye(e={}){const{emit:t,checkoutEveryNms:r,checkoutEveryNth:n,blockClass:o="rr-block",blockSelector:a=null,ignoreClass:l="rr-ignore",ignoreSelector:i=null,maskTextClass:s="rr-mask",maskTextSelector:c=null,inlineStylesheet:d=!0,maskAllInputs:u,maskInputOptions:p,slimDOMOptions:m,maskInputFn:f,maskTextFn:h,hooks:y,packFn:S,sampling:b={},dataURLOptions:g={},mousemoveWait:v,recordDOM:x=!0,recordCanvas:D=!1,recordCrossOriginIframes:V=!1,recordAfter:U=e.recordAfter==="DOMContentLoaded"?e.recordAfter:"load",userTriggeredOnInput:z=!1,collectFonts:H=!1,inlineImages:X=!1,plugins:k,keepIframeSrcFn:Z=()=>!1,ignoreCSSAttributes:$=new Set([]),errorHandler:J}=e;kr(J);const G=V?window.parent===window:!0;let Le=!1;if(!G)try{window.parent.document&&(Le=!1)}catch{Le=!0}if(G&&!t)throw new Error("emit function is required");v!==void 0&&b.mousemove===void 0&&(b.mousemove=v),j.reset();const je=u===!0?{color:!0,date:!0,"datetime-local":!0,email:!0,month:!0,number:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0,textarea:!0,select:!0,password:!0}:p!==void 0?p:{password:!0},ze=m===!0||m==="all"?{script:!0,comment:!0,headFavicon:!0,headWhitespace:!0,headMetaSocial:!0,headMetaRobots:!0,headMetaHttpEquiv:!0,headMetaVerification:!0,headMetaAuthorship:m==="all",headMetaDescKeywords:m==="all"}:m||{};Sr();let Wt,He=0;const $t=w=>{for(const B of k||[])B.eventProcessor&&(w=B.eventProcessor(w));return S&&!Le&&(w=S(w)),w};R=(w,B)=>{var E;if(((E=Q[0])==null?void 0:E.isFrozen())&&w.type!==C.FullSnapshot&&!(w.type===C.IncrementalSnapshot&&w.data.source===I.Mutation)&&Q.forEach(_=>_.unfreeze()),G)t?.($t(w),B);else if(Le){const _={type:"rrweb",event:$t(w),origin:window.location.origin,isCheckout:B};window.parent.postMessage(_,"*")}if(w.type===C.FullSnapshot)Wt=w,He=0;else if(w.type===C.IncrementalSnapshot){if(w.data.source===I.Mutation&&w.data.isAttachIframe)return;He++;const _=n&&He>=n,ce=r&&w.timestamp-Wt.timestamp>r;(_||ce)&&Ee(!0)}};const Ne=w=>{R(N({type:C.IncrementalSnapshot,data:W({source:I.Mutation},w)}))},Ut=w=>R(N({type:C.IncrementalSnapshot,data:W({source:I.Scroll},w)})),jt=w=>R(N({type:C.IncrementalSnapshot,data:W({source:I.CanvasMutation},w)})),Mn=w=>R(N({type:C.IncrementalSnapshot,data:W({source:I.AdoptedStyleSheet},w)})),ee=new fn({mutationCb:Ne,adoptedStyleSheetCb:Mn}),te=new Gr({mirror:j,mutationCb:Ne,stylesheetManager:ee,recordCrossOriginIframes:V,wrappedEmit:R});for(const w of k||[])w.getMirror&&w.getMirror({nodeMirror:j,crossOriginIframeMirror:te.crossOriginIframeMirror,crossOriginIframeStyleMirror:te.crossOriginIframeStyleMirror});const Be=new yn;Re=new mn({recordCanvas:D,mutationCb:jt,win:window,blockClass:o,blockSelector:a,mirror:j,sampling:b.canvas,dataURLOptions:g});const De=new Qr({mutationCb:Ne,scrollCb:Ut,bypassOptions:{blockClass:o,blockSelector:a,maskTextClass:s,maskTextSelector:c,inlineStylesheet:d,maskInputOptions:je,dataURLOptions:g,maskTextFn:h,maskInputFn:f,recordCanvas:D,inlineImages:X,sampling:b,slimDOMOptions:ze,iframeManager:te,stylesheetManager:ee,canvasManager:Re,keepIframeSrcFn:Z,processedNodeManager:Be},mirror:j});Ee=(w=!1)=>{if(!x)return;R(N({type:C.Meta,data:{href:window.location.href,width:ot(),height:nt()}}),w),ee.reset(),De.init(),Q.forEach(E=>E.lock());const B=yr(document,{mirror:j,blockClass:o,blockSelector:a,maskTextClass:s,maskTextSelector:c,inlineStylesheet:d,maskAllInputs:je,maskTextFn:h,slimDOM:ze,dataURLOptions:g,recordCanvas:D,inlineImages:X,onSerialize:E=>{it(E,j)&&te.addIframe(E),lt(E,j)&&ee.trackLinkElement(E),$e(E)&&De.addShadowRoot(E.shadowRoot,document)},onIframeLoad:(E,_)=>{te.attachIframe(E,_),E.contentWindow&&Re.addWindow(E.contentWindow),De.observeAttachShadow(E)},onStylesheetLoad:(E,_)=>{ee.attachLinkElement(E,_)},keepIframeSrcFn:Z});if(!B)return console.warn("Failed to snapshot the document");R(N({type:C.FullSnapshot,data:{node:B,initialOffset:rt(window)}}),w),Q.forEach(E=>E.unlock()),document.adoptedStyleSheets&&document.adoptedStyleSheets.length>0&&ee.adoptStyleSheets(document.adoptedStyleSheets,j.getId(document))};try{const w=[],B=_=>{var ce;return M(Vr)({mutationCb:Ne,mousemoveCb:(T,Ve)=>R(N({type:C.IncrementalSnapshot,data:{source:Ve,positions:T}})),mouseInteractionCb:T=>R(N({type:C.IncrementalSnapshot,data:W({source:I.MouseInteraction},T)})),scrollCb:Ut,viewportResizeCb:T=>R(N({type:C.IncrementalSnapshot,data:W({source:I.ViewportResize},T)})),inputCb:T=>R(N({type:C.IncrementalSnapshot,data:W({source:I.Input},T)})),mediaInteractionCb:T=>R(N({type:C.IncrementalSnapshot,data:W({source:I.MediaInteraction},T)})),styleSheetRuleCb:T=>R(N({type:C.IncrementalSnapshot,data:W({source:I.StyleSheetRule},T)})),styleDeclarationCb:T=>R(N({type:C.IncrementalSnapshot,data:W({source:I.StyleDeclaration},T)})),canvasMutationCb:jt,fontCb:T=>R(N({type:C.IncrementalSnapshot,data:W({source:I.Font},T)})),selectionCb:T=>{R(N({type:C.IncrementalSnapshot,data:W({source:I.Selection},T)}))},customElementCb:T=>{R(N({type:C.IncrementalSnapshot,data:W({source:I.CustomElement},T)}))},blockClass:o,ignoreClass:l,ignoreSelector:i,maskTextClass:s,maskTextSelector:c,maskInputOptions:je,inlineStylesheet:d,sampling:b,recordDOM:x,recordCanvas:D,inlineImages:X,userTriggeredOnInput:z,collectFonts:H,doc:_,maskInputFn:f,maskTextFn:h,keepIframeSrcFn:Z,blockSelector:a,slimDOMOptions:ze,dataURLOptions:g,mirror:j,iframeManager:te,stylesheetManager:ee,shadowDomManager:De,processedNodeManager:Be,canvasManager:Re,ignoreCSSAttributes:$,plugins:((ce=k?.filter(T=>T.observer))==null?void 0:ce.map(T=>({observer:T.observer,options:T.options,callback:Ve=>R(N({type:C.Plugin,data:{plugin:T.name,payload:Ve}}))})))||[]},y)};te.addLoadListener(_=>{try{w.push(B(_.contentDocument))}catch(ce){console.warn(ce)}});const E=()=>{Ee(),w.push(B(document)),xe=!0};return document.readyState==="interactive"||document.readyState==="complete"?E():(w.push(A("DOMContentLoaded",()=>{R(N({type:C.DomContentLoaded,data:{}})),U==="DOMContentLoaded"&&E()})),w.push(A("load",()=>{R(N({type:C.Load,data:{}})),U==="load"&&E()},window))),()=>{w.forEach(_=>_()),Be.destroy(),xe=!1,Or()}}catch(w){console.warn(w)}}return ye.addCustomEvent=(e,t)=>{if(!xe)throw new Error("please add custom event after start recording");R(N({type:C.Custom,data:{tag:e,payload:t}}))},ye.freezePage=()=>{Q.forEach(e=>e.freeze())},ye.takeFullSnapshot=e=>{if(!xe)throw new Error("please take full snapshot after start recording");Ee(e)},ye.mirror=j,ye}();
//# sourceMappingURL=rrweb-record.min.js.map
